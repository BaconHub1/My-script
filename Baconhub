
-- ======= Services =======
local Players = game:GetService("Players")
local VirtualUser = game:GetService("VirtualUser")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local StarterGui = game:GetService("StarterGui")

local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

-- ======= Anti-AFK =======
Player.Idled:Connect(function()
    VirtualUser:Button2Down(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
    task.wait(1)
    VirtualUser:Button2Up(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
end)

-- ======= Custom Notification Function =======
local function showCustomNotification(message)
    local old = PlayerGui:FindFirstChild("BaconHubNotification")
    if old then old:Destroy() end
    local gui = Instance.new("ScreenGui", PlayerGui)
    gui.Name = "BaconHubNotification"
    gui.ResetOnSpawn = false

    local frame = Instance.new("Frame", gui)
    frame.Size = UDim2.new(0,300,0,100)
    frame.Position = UDim2.new(1,-320,1,-120)
    frame.BackgroundColor3 = Color3.fromRGB(30,30,30)
    frame.BackgroundTransparency = 0.2
    frame.BorderSizePixel = 0
    frame.AnchorPoint = Vector2.new(1,1)
    frame.ClipsDescendants = true

    local avatar = Instance.new("ImageLabel", frame)
    avatar.Size = UDim2.new(0,80,0,80)
    avatar.Position = UDim2.new(0,10,0.5,-40)
    avatar.BackgroundTransparency = 1
    avatar.Image = "https://www.roblox.com/headshot-thumbnail/image?userId="..Player.UserId.."&width=420&height=420&format=png"

    local text = Instance.new("TextLabel", frame)
    text.Size = UDim2.new(1,-110,1,-20)
    text.Position = UDim2.new(0,100,0,10)
    text.BackgroundTransparency = 1
    text.Text = message
    text.TextColor3 = Color3.fromRGB(255,255,255)
    text.TextScaled = true
    text.Font = Enum.Font.GothamBold
    text.TextWrapped = true

    task.delay(5, function()
        for i=1,10 do
            frame.BackgroundTransparency += 0.05
            text.TextTransparency += 0.05
            avatar.ImageTransparency += 0.05
            task.wait(0.05)
        end
        gui:Destroy()
    end)
end

-- ======= Executor Detection =======
local function detectExecutor()
    if syn then return "Synapse X" end
    if KRNL_LOADED then return "Krnl" end
    if secure_load then return "Sentinel" end
    if is_sirhurt_cl then return "Sirhurt" end
    if identifyexecutor then return identifyexecutor() end
    return "Unknown"
end

-- ======= Welcome Notification =======
showCustomNotification("Welcome "..Player.Name.."!\nExecutor: "..detectExecutor())

-- ======= Countdown Loader =======
local function runWithCountdown(seconds, scriptFunc)
    local gui = Instance.new("ScreenGui", PlayerGui)
    gui.Name = "LoadingScriptGui"
    gui.ResetOnSpawn = false
    local label = Instance.new("TextLabel", gui)
    label.Size = UDim2.new(0.3,0,0.08,0)
    label.Position = UDim2.new(0.35,0,0.85,0)
    label.BackgroundTransparency = 0.2
    label.BackgroundColor3 = Color3.fromRGB(20,20,20)
    label.TextColor3 = Color3.fromRGB(255,255,255)
    label.Font = Enum.Font.GothamBold
    label.TextScaled = true
    label.Text = "Loading Script... Estimated: "..seconds.."s"

    for i = seconds - 1, 0, -1 do
        task.wait(1)
        label.Text = "Loading Script... Estimated: "..i.."s"
    end

    gui:Destroy()
    local ok, err = pcall(scriptFunc)
    if not ok then
        showCustomNotification("Ã¢ÂÂ Ã¯Â¸Â Script Error:\n"..tostring(err))
    end
end

-- ======= Load UI =======
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/DenDenZZZ/Kavo-UI-Library/main/Kavo.lua"))()
local Window = Library.CreateLib("BaconHub","BloodTheme")

-- ======= Credits Tab =======
local Credits = Window:NewTab("Credits")
local CR = Credits:NewSection("Info")
CR:NewLabel("This is the official BaconHub.")
CR:NewLabel("Thanks to Hehehe on Discord.")
CR:NewLabel("Thanks for using this script!")
CR:NewButton("Rejoin Server","",function()
    runWithCountdown(2, function() TeleportService:Teleport(game.PlaceId,Player) end)
end)
CR:NewButton("Server Hop","",function()
    runWithCountdown(3, function()
        local ok,servers = pcall(function()
            return HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?limit=100"))
        end)
        if ok and servers and servers.data then
            for _,s in ipairs(servers.data) do
                if s.playing<s.maxPlayers and s.id~=game.JobId then
                    TeleportService:TeleportToPlaceInstance(game.PlaceId,s.id,Player)
                    break
                end
            end
        end
    end)
end)

-- ======= Fly Tab =======
local Fly = Window:NewTab("Fly")
local F = Fly:NewSection("Fly Options")
F:NewButton("Fly","",function()
    runWithCountdown(3, function()
        loadstring("\108\111\97\100\115\116\114\105\110\103\40\103\97\109\101\58\72\116\116\112\71\101\116\40\40\39\104\116\116\112\115\58\47\47\103\105\115\116\46\103\105\116\104\117\98\117\115\101\114\99\111\110\116\101\110\116\46\99\111\109\47\109\101\111\122\111\110\101\89\84\47\98\102\48\51\55\100\102\102\57\102\48\97\55\48\48\49\55\51\48\52\100\100\100\54\55\102\100\99\100\51\55\48\47\114\97\119\47\101\49\52\101\55\52\102\52\50\53\98\48\54\48\100\102\53\50\51\51\52\51\99\102\51\48\98\55\56\55\48\55\52\101\98\51\99\53\100\50\47\97\114\99\101\117\115\37\50\53\50\48\120\37\50\53\50\48\102\108\121\37\50\53\50\48\50\37\50\53\50\48\111\98\102\108\117\99\97\116\111\114\39\41\44\116\114\117\101\41\41\40\41\10\10")()
    end)
end)
F:NewButton("FPS Boost","",function()
    runWithCountdown(2, function()
        for _,o in ipairs(game:GetDescendants()) do
            if o:IsA("Texture") or o:IsA("Decal") or o:IsA("ParticleEmitter") or o:IsA("Trail") then
                o:Destroy()
            end
        end
        pcall(function()
            sethiddenproperty(game.Lighting,"Technology",Enum.Technology.Compatibility)
        end)
        game.Lighting.GlobalShadows = false
        game.Lighting.FogEnd = 1e5
    end)
end)

local infJump = false
UserInputService.JumpRequest:Connect(function()
    if infJump then
        local char = Player.Character or Player.CharacterAdded:Wait()
        local h = char:FindFirstChildOfClass("Humanoid")
        if h then h:ChangeState(Enum.HumanoidStateType.Jumping) end
    end
end)
F:NewToggle("Infinite Jump","",function(s) infJump=s end)

-- ======= MM2 Tab =======
local MM2 = Window:NewTab("MM2")
local M2 = MM2:NewSection("Xhub Loader")
M2:NewButton("Load Xhub","",function()
    runWithCountdown(4, function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/andreylangtoh01/Xhub/refs/heads/main/Xhub"))()
    end)
end)
M2:NewButton("Egg Farm","",function()
    runWithCountdown(3, function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/AmareScripts/MM2/refs/heads/main/Easter%25AutoFarm.lua"))()
    end)
end)

-- ======= Super Tab (Secret) =======
local Super = Window:NewTab("Super")
local SU = Super:NewSection("Secret Script")
SU:NewButton("Super S&J","",function()
    runWithCountdown(3, function()
        loadstring(game:HttpGet("https://pastebin.com/raw/mekUsJ6i"))()
    end)
end)

-- ======= Troll Tab =======
local Troll = Window:NewTab("Troll")
local TR = Troll:NewSection("FE Troll Tools")
TR:NewButton("Fling Touch","",function()
    runWithCountdown(2, function()
        loadstring(game:HttpGet("https://rawscripts.net/raw/Universal-Script-Touch-fling-script-22447"))()
    end)
end)
TR:NewButton("Invisible","",function()
    runWithCountdown(2, function()
        loadstring(game:HttpGet("https://pastebin.com/raw/3Rnd9rHf"))()
    end)
end)
TR:NewButton("bacon Admin","",function()
    runWithCountdown(3, function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/BaconHub1/MM2FarmScript/refs/heads/main/EasterAutoFarm.lua."))()
    end)
end)
TR:NewButton("Bypass Chat","",function()
    runWithCountdown(3, function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/twig76/ayra/refs/heads/main/ayras"))()
    end)
end)
TR:NewButton("Player ESP","",function()
    runWithCountdown(3, function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/cool83birdcarfly02six/UNIVERSALESPLTX/main/README.md"))()
    end)
end)

-- ======= Blade Ball Tab =======
local BBTab = Window:NewTab("Blade Ball")
local BBSection = BBTab:NewSection("Kalitor")

BBSection:NewButton("BladeBall OP", "Loads OP bladeball script", function()
    runWithCountdown(3, function()
        loadstring(game:HttpGet("https://api.luarmor.net/files/v3/loaders/a70e413180d7ede96d4a09705648f630.lua"))()
    end)
end)

BBSection:NewButton("Ash", "Loads Ash script", function()
    runWithCountdown(3, function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/sirapobsriumang/Blade-ball/main/Blade-ball-free.lua"))()
    end)
end)

BBSection:NewButton("Kryptonite", "Loads Kryptonite script", function()
    runWithCountdown(3, function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/Bitcoinlol/Kryptonite-free/refs/heads/main/Protected_5085813520974140.lua.txt"))()
    end)
end)

BBSection:NewButton("108", "Loads 108 script", function()
    runWithCountdown(3, function()
        loadstring(game:HttpGet("https://pastefy.app/EgdTvwzS/raw"))()
    end)
end)

BBSection:NewButton("Athenamikaela", "Loads Ash script alternate", function()
    runWithCountdown(3, function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/Athenamikaela/Key/refs/heads/main/Protected_9421685464654481.lua.txt"))()
    end)
end)






-- ======= Discord Tab =======
local D = Window:NewTab("Discord"):NewSection("Join Our Server")
D:NewButton("Join Discord","",function()
    runWithCountdown(2, function()
        if setclipboard then
            setclipboard("https://discord.gg/w6PyskFT47")
            showCustomNotification("Discord link copied!")
        else
            showCustomNotification("Clipboard not supported.")
        end
    end)
end)

-- ======= Executor Tab =======
local EX = Window:NewTab("Executor"):NewSection("Script Runner")
local saved, histBtns = {}, {}
local outLbl = EX:NewLabel("Output will appear here.")
local function updateHistory()
    for _,btn in ipairs(histBtns) do btn:Remove() end
    histBtns = {}
    for i,code in ipairs(saved) do
        local short = code:sub(1,30):gsub("\n"," ")..(#code>30 and "..." or "")
        local btn = EX:NewButton("Run #"..i, short, function()
            runWithCountdown(2, function()
                local ok, e = pcall(loadstring(code))
                outLbl.Text = ok and "Script #"..i.." ran!" or "Error: "..tostring(e)
            end)
        end)
        table.insert(histBtns, btn)
    end
end

EX:NewTextBox("Run Script","",function(c)
   if c ~= "" then
       runWithCountdown(3, function()
           local ok,r = pcall(loadstring(c))
           outLbl.Text = ok and "Ran!" or "Error: "..tostring(r)
           if ok then
               table.insert(saved,1,c)
               if #saved > 5 then table.remove(saved,6) end
               updateHistory()
           end
       end)
   else outLbl.Text = "No script!" end
end)
EX:NewTextBox("Run Script from URL","",function(url)
   if url ~= "" then
       runWithCountdown(3, function()
           local ok,res = pcall(game.HttpGet, game, url)
           if ok then
               local ok2, r2 = pcall(loadstring(res))
               outLbl.Text = ok2 and "Loaded!" or "Error: "..tostring(r2)
               if ok2 then
                   table.insert(saved,1,res)
                   if #saved > 5 then table.remove(saved,6) end
                   updateHistory()
               end
           else
               outLbl.Text = "Fetch failed!"
           end
       end)
   else outLbl.Text = "No URL!" end
end)
EX:NewButton("Clear Output",""," ",function() outLbl.Text = "" end)

-- ======= Universal Tab =======
local U = Window:NewTab("Universal"):NewSection("FE Scripts")
U:NewButton("Invisible 2.1","",function()
    runWithCountdown(2, function()
        loadstring(game:HttpGet("https://pastebin.com/raw/vP6CrQJj"))()
    end)
end)
U:NewButton("Aimbot","",function()
    runWithCountdown(4, function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/DanielHubll/DanielHubll/refs/heads/main/Aimbot%20Mobile"))()
    end)
end)
U:NewButton("Hitbox Extender","",function()
    runWithCountdown(3, function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/AAPVdev/scripts/refs/heads/main/UI_LimbExtender.lua"))()
    end)
end)
U:NewButton("console cmd bar", "Opens command bar", function()
    runWithCountdown(2, function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/Dhelannn/Test/refs/heads/main/Test1"))()
    end)
end)


-- ======= Music Tab =======
local M = Window:NewTab("Music")
local MS = M:NewSection("Personal Music Player")
local sInst
MS:NewTextBox("Sound ID","",function(id)
    runWithCountdown(3, function()
        if sInst then sInst:Stop(); sInst:Destroy() end
        if id:match("^%d+$") then
            sInst = Instance.new("Sound", PlayerGui)
            sInst.SoundId = "rbxassetid://"..id
            sInst.Volume = 1
            sInst.Looped = true
            sInst:Play()
        else
            warn("Invalid ID!")
        end
    end)
end)
MS:NewButton("Stop Music","",function()
    runWithCountdown(1, function()
        if sInst then sInst:Stop(); sInst:Destroy(); sInst = nil end
    end)
end)

U:NewButton("Click Teleport (Tool)", "", function()
    runWithCountdown(2, function()
        local tool = Instance.new("Tool")
        tool.RequiresHandle = false
        tool.Name = "ClickTP"
        tool.Parent = game.Players.LocalPlayer.Backpack

        tool.Activated:Connect(function()
            local player = game.Players.LocalPlayer
            local mouse = player:GetMouse()
            if mouse and mouse.Hit then
                local character = player.Character or player.CharacterAdded:Wait()
                if character and character:FindFirstChild("HumanoidRootPart") then
                    -- Teleport
                    character:MoveTo(mouse.Hit.p)

                    -- Create marker
                    local marker = Instance.new("Part")
                    marker.Anchored = true
                    marker.CanCollide = false
                    marker.Size = Vector3.new(0.8, 0.8, 0.8)
                    marker.Shape = Enum.PartType.Ball
                    marker.Material = Enum.Material.Neon
                    marker.Color = Color3.fromRGB(255, 0, 0)
                    marker.Position = mouse.Hit.p + Vector3.new(0, 1, 0)
                    marker.Parent = workspace

                    -- Auto-remove after a few seconds
                    game:GetService("Debris"):AddItem(marker, 3)
                end
            end
        end)
    end)
end)
-- ======= [BaconHub Enhancements] ======= --

-- Console Tab (Script Error Logger)
local ConsoleTab = Window:NewTab("Console")
local CS = ConsoleTab:NewSection("Script Output Logs")
local consoleLogs, logLabels = {}, {}
local logBox = CS:NewLabel("Log Empty")
local function log(msg, isErr)
    local t = "[" .. os.date("%H:%M:%S") .. "] " .. (isErr and "[Error] " or "[Info] ") .. msg
    table.insert(consoleLogs, 1, t)
    if #consoleLogs > 5 then table.remove(consoleLogs, 6) end
    logBox.Text = table.concat(consoleLogs, "\n")
end

-- ======= Enhanced FPS & Ping Monitor (Draggable + RGB + Toggleable) =======
local CoreGui = game:GetService("CoreGui")
local function setupFPSMonitor()
    local old = CoreGui:FindFirstChild("FPSMonitor")
    if old then old:Destroy() end

    local fpsGui = Instance.new("ScreenGui")
    fpsGui.Name = "FPSMonitor"
    fpsGui.ResetOnSpawn = false
    fpsGui.IgnoreGuiInset = true
    fpsGui.Parent = CoreGui

    local fpsFrame = Instance.new("Frame", fpsGui)
    fpsFrame.Size = UDim2.new(0, 200, 0, 40)
    fpsFrame.Position = UDim2.new(0, 10, 0, 50)
    fpsFrame.BackgroundTransparency = 0.2
    fpsFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    fpsFrame.Active = true
    fpsFrame.Draggable = true

    local fpsLabel = Instance.new("TextLabel", fpsFrame)
    fpsLabel.Size = UDim2.new(1, 0, 1, 0)
    fpsLabel.BackgroundTransparency = 1
    fpsLabel.Text = "Initializing..."
    fpsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    fpsLabel.Font = Enum.Font.GothamBold
    fpsLabel.TextScaled = true

    local toggleBtn = Instance.new("TextButton", fpsGui)
    toggleBtn.Size = UDim2.new(0, 30, 0, 30)
    toggleBtn.Position = UDim2.new(0, 220, 0, 50)
    toggleBtn.Text = "-"
    toggleBtn.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    toggleBtn.TextColor3 = Color3.fromRGB(255, 0, 0)
    toggleBtn.Font = Enum.Font.GothamBold
    toggleBtn.TextScaled = true

    toggleBtn.MouseButton1Click:Connect(function()
        fpsFrame.Visible = not fpsFrame.Visible
        toggleBtn.Text = fpsFrame.Visible and "-" or "+"
    end)

    local frames, lastUpdate = 0, tick()
    RunService.Heartbeat:Connect(function()
        frames += 1
        local now = tick()
        if now - lastUpdate >= 1 then
            local ping = math.floor(game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue())
            local hue = tick() % 5 / 5
            fpsLabel.TextColor3 = Color3.fromHSV(hue, 1, 1)
            fpsLabel.Text = "FPS: " .. frames .. " | Ping: " .. ping .. "ms"
            frames = 0
            lastUpdate = now
        end
    end)
end

setupFPSMonitor()
-- ======= Toggle UI Button =======
local ToggleGui = Instance.new("ScreenGui")
ToggleGui.Name = "ToggleUI"
ToggleGui.ResetOnSpawn = false
ToggleGui.Parent = PlayerGui

local Toggle = Instance.new("TextButton")
Toggle.Name = "Toggle"
Toggle.Parent = ToggleGui
Toggle.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Toggle.Position = UDim2.new(0, 10, 0.45, 0)
Toggle.Size = UDim2.new(0, 140, 0, 40)
Toggle.Font = Enum.Font.GothamBold
Toggle.Text = "Close / Open"
Toggle.TextColor3 = Color3.fromRGB(255, 0, 0)
Toggle.TextScaled = true
Toggle.TextWrapped = true
Toggle.Draggable = true
Toggle.Active = true

local Corner = Instance.new("UICorner")
Corner.CornerRadius = UDim.new(0, 10)
Corner.Parent = Toggle

Toggle.MouseButton1Click:Connect(function()
    if Library then
        Library:ToggleUI()
    end
end)
